name = "egress-consumer"
main = "src/index.js"
compatibility_date = "2024-01-01"
account_id = "fffa4b4363a7e5250af8357087263b3a"  # Storacha Network

##################################################
########### Production Environment ###############
##################################################
[env.production]
name = "egress-consumer-production"

[[env.production.queues.consumers]]
queue = "egress-tracking-queue-production"
max_batch_size = 100  # Increased from 50 to max limit
max_batch_timeout = 60  # Increased from 30 to max (60 seconds)
max_retries = 3
dead_letter_queue = "egress-dlq-production"

[env.production.limits]
cpu_ms = 300000  # 5 minutes (max CPU time)

[env.production.vars]
UPLOAD_API_URL = "https://up.storacha.network"

##################################################
########### Staging Environment ##################
##################################################
[env.staging]
name = "egress-consumer-staging"

[[env.staging.queues.consumers]]
queue = "egress-tracking-queue-staging"
max_batch_size = 3
max_batch_timeout = 30
max_retries = 3
dead_letter_queue = "egress-dlq-staging"

[env.staging.vars]
UPLOAD_API_URL = "https://staging.up.storacha.network"
